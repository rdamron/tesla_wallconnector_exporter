api:
  enabled: true

sources:
  # Scrape Prometheus metrics from Tesla Wall Connector exporter
  twc_metrics:
    type: prometheus_scrape
    endpoints:
      - http://localhost:56852/metrics
    scrape_interval_secs: 15

transforms:
  rewrite_labels:
    type: remap
    inputs: ["twc_metrics"]
    source: |
      .tags.job = "prometheus-remote-write"
      .tags.origin = "hostname"
      .tags.instance = "hostname:56852"

sinks:
  #  print:
  #    type: "console"
  #    inputs: ["rewrite_labels"]
  #    encoding:
  #      codec: "json"
  #      json:
  #        pretty: true
  prometheus_remote:
    type: prometheus_remote_write
    inputs:
      - rewrite_labels
    endpoint: https://prometheus.example.com/api/v1/write
    healthcheck:
      enabled: false
    auth:
      strategy: basic
      user: your_username
      password: your_password
    batch:
      max_bytes: 524288
      max_events: 1
